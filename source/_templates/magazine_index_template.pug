extends /_templates/layout.pug
include /_templates/mixins.pug

block content
    .container-fluid
        .row
            section.event-banner.carousel.slide(id='front-carousel' data-ride='carousel')
                .carousel-inner(role="listbox")

                    - var bigPhotos = []
                    if self.hero_images
                        - bigPhotos = self.hero_images

                    if bigPhotos.length === 0
                        - bigPhotos = ['/assets/images/placeholder.jpg']

                    - var photoActive = 0
                    each photo in bigPhotos
                        .item(class=(photoActive === 0 ? 'active' : ''))
                            - photo = photo === '/assets/images/placeholder.jpg' ? photo : `${m_api}${photo}`
                            figure(id = `slide-${photoActive}`, style=`background-image: url('${photo}');`)
                            - photoActive++
                            header.col-md-8
                                p
                                    +dateFull(self.publish_date)
                                h1.artist= self[`title_${self.locale}`]
                                    if self[`subtitle_${self.locale}`]
                                        - var subTitle = self[`subtitle_${self.locale}`]
                                        span= ` / ${subTitle}`
                                if self.authors_cs
                                    p.subtitle= self.authors_cs

                if bigPhotos.length > 1
                    a.left.carousel-control(href='#front-carousel' role='button' data-slide='prev')
                        span.icon-prev.arrow-left(aria-hidden='true')
                        span.sr-only Previous
                    a.right.carousel-control(href='#front-carousel' role='button' data-slide='next')
                        span.icon-next.arrow-right(aria-hidden='true')
                        span.sr-only Next
                            ul.event-categories

                //- Gradient Map for images
                each photo, ix in bigPhotos
                    script.
                        var slide#{ix} = document.getElementById('slide-#{ix}');
                        GradientMaps.applyGradientMap(slide#{ix}, '#000000, #FFC600');

        .row.front-page-margin
            .col-md-12
                .row
                    //- SOUND
                    if self.audios
                        .video-sound
                            //- h2= t('title.sound')
                            each audio in self.audios
                                div!= audio
                    div(class='article main-text h3 col-sm-12 col-md-8 col-lg-8 photo-article-' + self.photo_article)
                        | !{self.md(self[`content_${self.locale}`])}


                        //- GALLERY
                        if self.article_media && !self.hide_gallery
                            .gallery
                                    .row

                                    - var mediumImages = self.article_media.filter(a => a.gallery_image_medium)

                                    if mediumImages.length === 1
                                        .row
                                            .col-xs-12
                                                img(src=`${m_api}${mediumImages[0].hero_image ? mediumImages[0].hero_image.url : mediumImages[0].gallery_image_medium.url}`, class='img-responsive')

                                    if mediumImages.length > 1
                                        h2= self.labels.title.gallery
                                        each galPhoto in mediumImages
                                            if galPhoto.gallery_image_medium
                                                .single-image.col-xs-6.col-sm-3.col-md-4

                                                    if galPhoto.hero_image && galPhoto.hero_image.url
                                                        - var imgLink = galPhoto.hero_image.url
                                                    else
                                                        - var imgLink = galPhoto.gallery_image_medium.url

                                                    a.fancybox(rel="gallery" href=`${m_api}${imgLink}`)
                                                        img.img-responsive(src=`${m_api}${galPhoto.gallery_image_medium.url}`)


                        //- VIDEO
                        if self.videos
                            .video-sound
                                h2= self.labels.title.video
                                each video in self.videos
                                    div!= video.content

                        .comments
                            .fb-comments(data-href='', data-width="100%", data-numposts="10")

                            script.
                                document.getElementsByClassName('fb-comments')[0].setAttribute('data-href', window.location.href)

                    - var postCount = 0
                    .col-sm-12.col-md-4.col-lg-4
                        if self.related && self.related.length
                            h2= self.labels.title.related_articles
                            each relArticle in self.related
                                if postCount++ < 15
                                    //- a(href=`/${lang_path}${relArticle.path}`)
                                    a(href=`/${relArticle.path}`)
                                        p
                                            +dateFull(self.publish_date)
                                        h3
                                            span.artist= relArticle[`title_${self.locale}`]

                                            if relArticle[`subtitle_${self.locale}`]
                                                span.artist= `/ ${relArticle[`subtitle_${self.locale}`]}`
                                        if relArticle.authors_cs
                                            span.author= relArticle.authors_cs
                                    hr

                            .row
                                .col-xs-12.col-md-12
                                    a.load-more.btn.btn-primary(href=`/${lang_path}magazine/`)= self.labels.button.view_all
